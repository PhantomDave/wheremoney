<mat-card class="widget-card">
  <mat-card-header class="widget-header">
    <div class="drag-handle">
      <mat-icon>drag_indicator</mat-icon>
    </div>
    <mat-card-title>{{ widgetValue()?.name || 'Untitled Widget' }}</mat-card-title>
    <div class="widget-actions">
      @if (widgetValue()) {
        <mat-icon (click)="openSettings()" (keydown)="openSettings()" class="settings-icon"
          >settings</mat-icon
        >
      }
    </div>
  </mat-card-header>

  <mat-card-content class="widget-content">
    @if (widgetValue() && selectedTable && data && !isLoading) {
      @switch (widgetValue()?.type) {
        @case (WidgetType.PIE_CHART) {
          <app-pie-chart-component
            [widget]="widgetValue()"
            [table]="selectedTable"
            [data]="data"
            [isLoading]="isLoading"
          />
        }
        @case (WidgetType.BAR_CHART) {
          <app-bar-chart-component
            [widget]="widgetValue()"
            [table]="selectedTable"
            [data]="data"
            [isLoading]="isLoading"
          />
        }
        @default {
          <p>Unknown widget type</p>
        }
      }
    } @else {
      <p>No data available for this widget.</p>
    }
  </mat-card-content>
</mat-card>
