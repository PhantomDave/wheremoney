<h2 mat-dialog-title>Configure {{ data.widgetType }} Widget for {{ data.table.name }}</h2>
<mat-dialog-content>
  <p>Select the columns you want to include in the {{ data.widgetType }} widget:</p>
  <p>Widget ID: {{ data.widgetId }}</p>
  <p>Table ID: {{ data.table.id }}</p>

  <div class="column-selection">
    <mat-checkbox
      (change)="$event ? toggleAllRows() : null"
      [checked]="selection.hasValue() && isAllSelected()"
      [indeterminate]="selection.hasValue() && !isAllSelected()"
      (keydown)="$event.key === 'Enter' ? toggleAllRows() : null"
    >
      Select All Columns
    </mat-checkbox>

    @for (column of data.table.columns; track column.id) {
      <mat-checkbox
        (click)="$event.stopPropagation()"
        (change)="$event ? selection.toggle(column) : null"
        [checked]="selection.isSelected(column)"
        (keydown)="$event.key === 'Enter' ? selection.toggle(column) : null"
      >
        {{ column.name }} ({{ column.data_type }})
      </mat-checkbox>
      <mat-form-field>
        <mat-label>Select Table</mat-label>
        <mat-select (selectionChange)="onTypeSelectionChange($event.value, column)">
          @for (type of types; track $index) {
            <mat-option [value]="type">{{ type }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    }
  </div>
</mat-dialog-content>
<mat-dialog-actions>
  <button matButton (click)="onNoClick()">Cancel</button>
  <button matButton [mat-dialog-close]="save()" cdkFocusInitial>Configure Widget</button>
</mat-dialog-actions>
